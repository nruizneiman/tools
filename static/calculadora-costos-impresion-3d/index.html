<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calculadora de Costos 3D</title>
  <style>
    body {
      background-color: #1a1a1a;
      color: #f2f2f2;
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 20px;
    }

    h1 {
      text-align: center;
      color: #9f6fff;
      margin-bottom: 10px;
      font-size: 24px;
    }

    .currency-buttons {
      text-align: center;
      margin-bottom: 20px;
    }

    .currency-buttons button {
      background-color: #444;
      color: #fff;
      border: none;
      padding: 10px 20px;
      margin: 0 5px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }

    .currency-buttons button.active {
      background-color: #9f6fff;
    }

    .grid-container {
      display: flex;
      flex-direction: column;
      gap: 20px;
      width: 100%;
    }

    .section {
      background: #2a2a2a;
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
    }

    h2 {
      color: #9f6fff;
      font-size: 18px;
      margin-bottom: 15px;
      border-bottom: 1px solid #444;
      padding-bottom: 5px;
    }

    label {
      display: block;
      margin-bottom: 12px;
      font-size: 14px;
    }

    input[type="number"] {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #444;
      background-color: #1a1a1a;
      color: #fff;
      font-size: 14px;
      box-sizing: border-box;
    }

    .tiempo {
      display: flex;
      gap: 10px;
    }

    .tiempo div {
      flex: 1;
    }

    .tiempo small {
      display: block;
      font-size: 12px;
      color: #ccc;
      margin-bottom: 4px;
      margin-left: 2px;
    }

    button#calcularBtn {
      display: block;
      margin: 40px auto 0;
      padding: 12px 30px;
      background-color: #9f6fff;
      color: #fff;
      font-size: 16px;
      font-weight: bold;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    button#calcularBtn:hover {
      background-color: #b78dff;
    }

    .note {
      font-size: 14px;
      margin-top: 12px;
      line-height: 1.5;
    }

    .note-title {
      color: #ff4444;
      font-weight: bold;
      margin-bottom: 4px;
    }

    .result {
      margin: 40px auto 0;
      background-color: #262626;
      padding: 25px 30px;
      border-radius: 14px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
      color: #f2f2f2;
      font-size: 16px;
      line-height: 1.6;
    }

    .result-line {
      display: flex;
      justify-content: space-between;
      border-bottom: 1px solid #333;
      padding: 6px 0;
    }

    .highlight {
      color: #ddd;
      font-weight: 500;
    }

    .costo {
      color: #b78dff;
      font-weight: bold;
    }

    .total {
      font-size: 18px;
      font-weight: bold;
      color: #9f6fff;
    }

    .ml {
      font-size: 18px;
      font-weight: bold;
      color: #ffff00;
    }
  </style>
</head>
<body>
  <h1>Calculadora de Costos 3D</h1>

  <div class="currency-buttons">
    <button onclick="seleccionarMoneda('ARS')" class="active">ARS $</button>
    <button onclick="seleccionarMoneda('USD')">USD US$</button>
    <button onclick="seleccionarMoneda('EUR')">EUR €</button>
  </div>

  <div class="grid-container">
    <div class="section">
      <h2>Gastos Fijos</h2>
      <label>Precio KG (<span id="simbolo">ARS $</span>): <input type="number" id="precioKg" /></label>
      <label>Precio Kwh (<span id="simbolo2">ARS $</span>): <input type="number" id="precioKwh" /></label>
      <label>Consumo real por hora (W): <input type="number" id="consumo" value="120" /></label>
      <label>Desgaste máquina (horas): <input type="number" id="desgasteHoras" value="4320" /></label>
      <label>Precio Repuestos (<span id="simbolo3">ARS $</span>): <input type="number" id="precioRepuestos" /></label>
      <label>% Margen de Error: <input type="number" id="margenError" value="30" /></label>
    </div>

    <div class="section">
      <h2>Pieza</h2>
      <label>
        Tiempo de impresión:
        <div class="tiempo">
          <div>
            <small>Horas</small>
            <input type="number" id="horasImpresionHoras" value="0" min="0" />
          </div>
          <div>
            <small>Minutos</small>
            <input type="number" id="horasImpresionMinutos" value="0" min="0" max="59" />
          </div>
        </div>
      </label>
      <label>Gramos de filamento: <input type="number" id="gramosFilamento" value="95" /></label>
      <label>INSUMOS (<span id="simbolo4">ARS $</span>): <input type="number" id="insumos" /></label>
    </div>

    <div class="section">
      <h2>Ganancia</h2>
      <label>Margen de ganancia (multiplicador): <input type="number" id="ganancia" value="5" /></label>
      <div class="note">
        <div class="note-title">Referencias:</div>
        Precio Minorista → 4<br>
        Precio Mayorista → 3<br>
        Precio Llaveros → 5
      </div>
    </div>
  </div>

  <button id="calcularBtn" onclick="calcular()">Calcular</button>

  <div class="result" id="resultados"></div>

  <script>
    let moneda = 'ARS';
    const simbolos = { 'ARS': 'ARS $', 'USD': 'USD US$', 'EUR': 'EUR €' };
    const valoresReferencia = {
      'ARS': { precioKg: 15000, precioKwh: 140, precioRepuestos: 150000, insumos: 0 },
      'USD': { precioKg: 15, precioKwh: 0.14, precioRepuestos: 100, insumos: 0 },
      'EUR': { precioKg: 15, precioKwh: 0.15, precioRepuestos: 110, insumos: 0 }
    };

    function seleccionarMoneda(monedaSeleccionada) {
      moneda = monedaSeleccionada;
      document.querySelectorAll('.currency-buttons button').forEach(btn => btn.classList.remove('active'));
      document.querySelector(`button[onclick*="${monedaSeleccionada}"]`).classList.add('active');

      document.getElementById("simbolo").textContent = simbolos[moneda];
      document.getElementById("simbolo2").textContent = simbolos[moneda];
      document.getElementById("simbolo3").textContent = simbolos[moneda];
      document.getElementById("simbolo4").textContent = simbolos[moneda];

      const valores = valoresReferencia[moneda];
      document.getElementById("precioKg").value = valores.precioKg;
      document.getElementById("precioKwh").value = valores.precioKwh;
      document.getElementById("precioRepuestos").value = valores.precioRepuestos;
      document.getElementById("insumos").value = valores.insumos;

      calcular();
    }

    function calcular() {
      const precioKg = parseFloat(document.getElementById("precioKg").value);
      const precioKwh = parseFloat(document.getElementById("precioKwh").value);
      const consumo = parseFloat(document.getElementById("consumo").value);
      const desgasteHoras = parseFloat(document.getElementById("desgasteHoras").value);
      const precioRepuestos = parseFloat(document.getElementById("precioRepuestos").value);
      const margenErrorPct = parseFloat(document.getElementById("margenError").value) / 100;

      const horas = parseFloat(document.getElementById("horasImpresionHoras").value || 0);
      const minutos = parseFloat(document.getElementById("horasImpresionMinutos").value || 0);
      const tiempoHoras = horas + minutos / 60;

      const gramos = parseFloat(document.getElementById("gramosFilamento").value);
      const insumos = parseFloat(document.getElementById("insumos").value) || 0;
      const ganancia = parseFloat(document.getElementById("ganancia").value);

      const precioMaterial = (precioKg / 1000) * gramos;
      const precioLuz = ((consumo / 1000) * precioKwh) * tiempoHoras;
      const desgasteMaquina = (precioRepuestos / desgasteHoras) * tiempoHoras;
      const margenDeError = (precioMaterial + precioLuz) * margenErrorPct;
      const costoLuzYMaterial = precioMaterial + precioLuz;
      const costoTotal = costoLuzYMaterial + desgasteMaquina + margenDeError;
      const totalCobrar = (costoTotal * ganancia) + insumos * 1.3;
      const precioML = totalCobrar + (costoTotal * 0.8);

      const simbolo = simbolos[moneda];

      document.getElementById("resultados").innerHTML = `
        <div class="result-line"><span>Precio Material:</span><span>${simbolo} ${precioMaterial.toFixed(2)}</span></div>
        <div class="result-line"><span>Precio Luz:</span><span>${simbolo} ${precioLuz.toFixed(2)}</span></div>
        <div class="result-line"><span>Desgaste Máquina:</span><span>${simbolo} ${desgasteMaquina.toFixed(2)}</span></div>
        <div class="result-line"><span>Margen de Error:</span><span>${simbolo} ${margenDeError.toFixed(2)}</span></div>
        <div class="result-line"><span>INSUMOS:</span><span>${simbolo} ${insumos.toFixed(2)}</span></div>
        <div class="result-line highlight"><span>Costo Luz y Material:</span><span>${simbolo} ${costoLuzYMaterial.toFixed(2)}</span></div>
        <div class="result-line costo"><span>Costo Total (incluye insumos):</span><span>${simbolo} ${costoTotal.toFixed(2)}</span></div>
        <div class="result-line total"><span>TOTAL A COBRAR:</span><span>${simbolo} ${totalCobrar.toFixed(2)}</span></div>
        ${moneda === 'ARS' ? `<div class="result-line ml"><span>PRECIO MERCADOLIBRE:</span><span>${simbolo} ${precioML.toFixed(2)}</span></div>` : ""}
      `;
    }

    seleccionarMoneda('ARS');
  </script>
</body>
</html>